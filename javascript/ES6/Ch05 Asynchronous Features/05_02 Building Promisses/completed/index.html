<!DOCTYPE html>
<html>
<head>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.29/browser.js"></script>
	<script type="text/babel">
		//asynchronous promise
		const spacePeople = () => {
			return new Promise((resolves, rejects) => {
				const api = 'http://api.open-notify.org/astros.json';
				const request = new XMLHttpRequest();
				request.open('GET', api);
				request.onload = () => {
					if(request.status === 200) {
						resolves(JSON.parse(request.response));
					} else {
						rejects(Error(request.statusText));
					}
				};
				request.onerror = err => rejects(err);
				request.send();
			});
		};
		//Then is called composition
		spacePeople().then(
			spaceData => console.log(spaceData),
			err => console.error(
				new Error('Cannot load space people')
			)
		);
		//-----------------------------------------------------
		//asynchronous promise
		const getFakeMembers = count => new Promise((resolves, rejects) => { 
			const api = `https://api.randomuser.me/?nat=US&results=${count}` const request = new XMLHttpRequest()
			request.open('GET', api)
			request.onload = () => 
				(request.status === 200) ?
				resolves(JSON.parse(request.response).results) :
			reject(Error(request.statusText)) 
			request.onerror = (err) => rejects(err) 
			request.send()
		})


		getFakeMembers(5).then(
			members => console.log(members), err => console.error(
			new Error("cannot load members from randomuser.me"))
		)
	</script>
	<title>Building Promises</title>
</head>
<body>
</body>	
</html>




